{"ast":null,"code":"var __jsx = React.createElement;\nimport React, { useState, useEffect, useContext, createContext } from \"react\";\nimport { httpClient } from \"./Api\";\nimport { Cookies } from \"react-cookie\";\nconst authContext = /*#__PURE__*/createContext({});\n\n// Provider component that wraps app and makes auth object ..\n// ... available to any child component that calls useAuth().\n\nexport function AuthProvider({\n  children\n}) {\n  const auth = useProvideAuth();\n  return __jsx(authContext.Provider, {\n    value: auth\n  }, children);\n}\n\n// Hook for child components to get the auth object ...\n// ... and re-render when it changes.\n\nexport const useAuth = () => {\n  return useContext(authContext);\n};\nconst useProvideAuth = () => {\n  const {\n    0: authUser,\n    1: setAuthUser\n  } = useState(null);\n  const {\n    0: isLoadingUser,\n    1: setLoadingUser\n  } = useState(true);\n  const {\n    0: isLoading,\n    1: setLoading\n  } = useState(false);\n  const {\n    0: error,\n    1: setError\n  } = useState('');\n  const fetchStart = () => {\n    setLoading(true);\n    setError('');\n  };\n  const fetchSuccess = () => {\n    setLoading(false);\n    setError('');\n  };\n  const fetchError = error => {\n    setLoading(false);\n    setError(error);\n  };\n  const userLogin = (data, callbackFun) => {\n    fetchStart();\n    httpClient.post('auth/login', data).then(({\n      data\n    }) => {\n      if (data.result) {\n        fetchSuccess();\n        httpClient.defaults.headers.common['Authorization'] = 'Bearer ' + data.token.access_token;\n        const cookies = new Cookies();\n        cookies.set('token', data.token.access_token);\n        getAuthUser();\n        if (callbackFun) callbackFun();\n      } else {\n        fetchError(data.error);\n      }\n    }).catch(function (error) {\n      fetchError(error.message);\n    });\n  };\n  const userSignup = (data, callbackFun) => {\n    fetchStart();\n    httpClient.post('auth/register', data).then(({\n      data\n    }) => {\n      if (data.result) {\n        fetchSuccess();\n        httpClient.defaults.headers.common['Authorization'] = 'Bearer ' + data.token.access_token;\n        const cookies = new Cookies();\n        cookies.set('token', data.token.access_token);\n        if (callbackFun) callbackFun();\n      } else {\n        fetchError(data.error);\n      }\n    }).catch(function (error) {\n      fetchError(error.message);\n    });\n  };\n  const userSignOut = callbackFun => {\n    fetchStart();\n    httpClient.post('auth/logout').then(({\n      data\n    }) => {\n      if (data.result) {\n        fetchSuccess();\n        setAuthUser(false);\n        httpClient.defaults.headers.common['Authorization'] = '';\n        const cookies = new Cookies();\n        cookies.remove('token');\n        if (callbackFun) callbackFun();\n      } else {\n        fetchError(data.error);\n      }\n    }).catch(function (error) {\n      fetchError(error.message);\n    });\n  };\n  const getAuthUser = () => {\n    fetchStart();\n    httpClient.post(\"auth/me\").then(({\n      data\n    }) => {\n      if (data.user) {\n        fetchSuccess();\n        setAuthUser(data.user);\n      } else {\n        fetchError(data.error);\n      }\n    }).catch(function (error) {\n      httpClient.defaults.headers.common['Authorization'] = '';\n      fetchError(error.message);\n    });\n  };\n\n  // Subscribe to user on mount\n  // Because this sets state in the callback it will cause any ...\n  // ... component that utilizes this hook to re-render with the ...\n  // ... latest auth object.\n\n  useEffect(() => {\n    const cookies = new Cookies();\n    const token = cookies.get(\"token\");\n    httpClient.defaults.headers.common['Authorization'] = 'Bearer ' + token;\n    httpClient.post(\"auth/me\").then(({\n      data\n    }) => {\n      if (data.user) {\n        setAuthUser(data.user);\n      }\n      setLoadingUser(false);\n    }).catch(function (error) {\n      cookies.remove('token');\n      httpClient.defaults.headers.common['Authorization'] = '';\n      setLoadingUser(false);\n    });\n  }, []);\n\n  // Return the user object and auth methods\n  return {\n    isLoadingUser,\n    isLoading,\n    authUser,\n    error,\n    setAuthUser,\n    getAuthUser,\n    userLogin,\n    userSignup,\n    userSignOut\n  };\n};\nexport const isUnRestrictedRoute = pathname => {\n  return pathname === '/signin' || pathname === '/signup' || pathname === '/forgot-password' || pathname === '/reset-password';\n};","map":{"version":3,"names":["React","useState","useEffect","useContext","createContext","httpClient","Cookies","authContext","AuthProvider","children","auth","useProvideAuth","__jsx","Provider","value","useAuth","authUser","setAuthUser","isLoadingUser","setLoadingUser","isLoading","setLoading","error","setError","fetchStart","fetchSuccess","fetchError","userLogin","data","callbackFun","post","then","result","defaults","headers","common","token","access_token","cookies","set","getAuthUser","catch","message","userSignup","userSignOut","remove","user","get","isUnRestrictedRoute","pathname"],"sources":["/home/novel/Desktop/medcario/lms/lms_admin/db-sl-admin/util/use-auth.js"],"sourcesContent":["import React, {useState, useEffect, useContext, createContext} from \"react\";\nimport {httpClient} from \"./Api\";\nimport {Cookies} from \"react-cookie\";\n\nconst authContext = createContext({});\n\n// Provider component that wraps app and makes auth object ..\n// ... available to any child component that calls useAuth().\n\nexport function AuthProvider({children}) {\n  const auth = useProvideAuth();\n  return <authContext.Provider value={auth}>{children}</authContext.Provider>;\n}\n\n// Hook for child components to get the auth object ...\n// ... and re-render when it changes.\n\nexport const useAuth = () => {\n  return useContext(authContext);\n};\n\nconst useProvideAuth = () => {\n  const [authUser, setAuthUser] = useState(null);\n  const [isLoadingUser, setLoadingUser] = useState(true);\n  const [isLoading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n\n  const fetchStart = () => {\n    setLoading(true);\n    setError('');\n  }\n\n  const fetchSuccess = () => {\n    setLoading(false);\n    setError('');\n  }\n\n  const fetchError = (error) => {\n    setLoading(false);\n    setError(error);\n  }\n\n  const userLogin = (data, callbackFun) => {\n    fetchStart();\n    httpClient.post('auth/login', data)\n      .then(({data}) => {\n        if (data.result) {\n          fetchSuccess();\n          httpClient.defaults.headers.common['Authorization'] = 'Bearer ' + data.token.access_token;\n          const cookies = new Cookies();\n          cookies.set('token', data.token.access_token);\n          getAuthUser();\n          if (callbackFun) callbackFun();\n        } else {\n          fetchError(data.error);\n        }\n      })\n      .catch(function (error) {\n        fetchError(error.message);\n      });\n  };\n\n  const userSignup = (data, callbackFun) => {\n    fetchStart();\n    httpClient.post('auth/register', data)\n      .then(({data}) => {\n        if (data.result) {\n          fetchSuccess();\n          httpClient.defaults.headers.common['Authorization'] = 'Bearer ' + data.token.access_token;\n          const cookies = new Cookies();\n          cookies.set('token', data.token.access_token);\n          if (callbackFun) callbackFun();\n        } else {\n          fetchError(data.error);\n        }\n      })\n      .catch(function (error) {\n        fetchError(error.message);\n      });\n  };\n\n  const userSignOut = (callbackFun) => {\n    fetchStart();\n    httpClient.post('auth/logout')\n      .then(({data}) => {\n        if (data.result) {\n          fetchSuccess();\n          setAuthUser(false);\n          httpClient.defaults.headers.common['Authorization'] = '';\n          const cookies = new Cookies();\n          cookies.remove('token');\n          if (callbackFun) callbackFun();\n        } else {\n          fetchError(data.error);\n        }\n      })\n      .catch(function (error) {\n        fetchError(error.message);\n      });\n  };\n\n  const getAuthUser = () => {\n    fetchStart();\n    httpClient.post(\"auth/me\").then(({data}) => {\n      if (data.user) {\n        fetchSuccess();\n        setAuthUser(data.user);\n      } else {\n        fetchError(data.error);\n      }\n    }).catch(function (error) {\n      httpClient.defaults.headers.common['Authorization'] = '';\n      fetchError(error.message);\n    });\n  }\n\n  // Subscribe to user on mount\n  // Because this sets state in the callback it will cause any ...\n  // ... component that utilizes this hook to re-render with the ...\n  // ... latest auth object.\n\n  useEffect(() => {\n      const cookies = new Cookies();\n      const token = cookies.get(\"token\");\n      httpClient.defaults.headers.common['Authorization'] = 'Bearer ' + token;\n\n    \n      httpClient.post(\"auth/me\").then(({data}) => {\n        if (data.user) {\n          setAuthUser(data.user);\n        }\n        setLoadingUser(false);\n      }).catch(function (error) {\n        cookies.remove('token');\n        httpClient.defaults.headers.common['Authorization'] = '';\n        setLoadingUser(false);\n      });\n    }, []\n  );\n\n  // Return the user object and auth methods\n  return {\n    isLoadingUser,\n    isLoading,\n    authUser,\n    error,\n    setAuthUser,\n    getAuthUser,\n    userLogin,\n    userSignup,\n    userSignOut,\n  };\n}\n\nexport const isUnRestrictedRoute = (pathname) => {\n  return pathname === '/signin' || pathname === '/signup' || pathname === '/forgot-password' || pathname === '/reset-password';\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}